from Config import TRAIN_MALWARE_PATH,TRAIN_NON_MALWARE_PATH
import Classifier
import Utils
import FeatureExtraction
import Statistics
import ExecutablePreprocess
from sys import argv
from os import system,name
from time import clock
import logging
import os, sys

DIR_TO_PREDICT = "./Predicts/"

def report(fname,cl,t):
	return """
*********** REPORT ***********
File:  %s
Class: %s
Time:  %d
""" % (fname,cl,t)

class WMD:
		
	def train(self):
		return Classifier._fit("./toTrain/Malw", "./toTrain/NoMalw", "prototypes.trained", "model_w2v.mm", "ffunctions.mm")
	
	def predict(self):
		files = os.listdir(DIR_TO_PREDICT)
		result = []
		for f in files:
			it = clock()
			c_class = Classifier._predict(DIR_TO_PREDICT+f, 1, "prototypes.trained", "model_w2v.mm", "ffunctions.mm")
			result.append(report(f, c_class, clock()-it))
			
		return result

	def stats(self):
		return Statistics._leaving_one_out("./toTrain/Malw","./toTrain/NoMalw",1)
			#DIR_TO_PREDICT = "C:\\Users\\EstebanMontesMorales\\Desktop\\wmdGUI\\wmdLocalGUI\\Predicts\\"


#print WMD().train()
#print WMD().predict()
#print WMD().stats()